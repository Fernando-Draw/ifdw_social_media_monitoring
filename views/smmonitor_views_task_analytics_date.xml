<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista de búsqueda para filtrado de búsqueda de smm.task.analytics.date -->
    <record id="view_task_search_actual_smmonitor" model="ir.ui.view">
        <field name="name">project.task.search.atual.smmonitor</field>
        <field name="model">smm.task.analytics.date</field>
        <field name="arch" type="xml">
            <search string="Tareas P.R.S.">
                <!-- Campos importados y heredados en el modelo smm.task.analytics.date de project.task para su usu aquí -->
                <field name="name" string="Tareas" filter_domain="['|', ('name', 'ilike', self), ('id', 'ilike', self)]"/>
                <field name="user_ids" filter_domain="[('user_ids.name', 'ilike', self), ('user_ids.active', 'in', [True, False])]"/>
                <field name="stage_id"/>
                <field name="milestone_id" groups="project.group_project_milestone"/>
                <field name="partner_id" operator="child_of"/>
                <!-- Campos principales del módulo IfDw Social Media Monitoring -->
                <field name="smm_datetask_id"/>
                <field name="datetakesdata"/>
                <field name="engagement"/>
                <field name="interactions"/>
                <field name="reach"/>
                <field name="impressions"/>
                <!-- Filtros y agrupaciones -->
                <filter string="Seguida" name="followed_by_me" domain="[('message_is_follower', '=', True)]"/>
                <filter string="No asignado" name="unassigned" domain="[('user_ids', '=', False)]"/>
                <separator/>
                <filter string="Tareas favoritas" name="starred_tasks" domain="[('priority', '=', '1')]"/>
                <separator/>
                <filter string="Última actualización de la etapa" name="date_last_stage_update" date="date_last_stage_update"/>
                <separator/>
                <filter string="Tareas abiertas" name="open_tasks" domain="[('state', 'in', ['01_in_progress', '02_changes_requested', '03_approved', '04_waiting_normal'])]"/>
                <filter string="Tareas cerradas" name="closed_tasks" domain="[('state', 'in', ['1_done','1_canceled'])]"/>
                <filter string="Cerrado en" name="closed_on" domain="[('state', 'in', ['1_done','1_canceled'])]" date="date_last_stage_update"/>
                <separator/>
                <filter string="Archivado" name="inactive" domain="[('active', '=', False)]"/>
                <separator/>
                <filter string="Tareas con registros de RR.SS." name="datetakesdata_enabled" domain="[('datetakesdata', '!=', False)]"/>
                <group expand="0" string="Agrupar por">
                    <filter string="Titulo" name="title" context="{'group_by': 'smm_datetask_id'}"/>
                    <filter string="Etapas" name="stage" context="{'group_by': 'stage_id'}"/>
                    <filter string="Hitos" name="milestone" context="{'group_by': 'milestone_id'}" groups="project.group_project_milestone"/>
                    <filter string="Clientes" name="customer" context="{'group_by': 'partner_id'}"/>
                    <filter string="Compañias" name="company_id" context="{'group_by': 'company_id'}" groups="base.group_multi_company"/>
                    <filter string="Fecha de creación" name="create_date" context="{'group_by': 'create_date'}"/>
                    <filter string="Fecha de asignación" name="date_assign" context="{'group_by': 'date_assign'}"/>
                    <filter string="Última actualización de la etapa" name="last_stage_update" context="{'group_by': 'date_last_stage_update'}"/>
                </group>
                <separator/>
                <group expand="0" string="Agrupar por">
                    <filter string="Vinculación (Egagmt)" name="engagement" context="{'group_by': 'engagement'}"/>
                    <filter string="Interacciones (CTR)" name="interactions" context="{'group_by': 'interactions'}"/>
                    <filter string="Alcance" name="reach" context="{'group_by': 'reach'}"/>
                    <filter string="Impresiones" name="impressions" context="{'group_by': 'impressions'}"/>
                </group>
                <separator/>
                <group expand="0" string="Agrupar por">
                    <filter string="Por fecha" name="datetakesdata" context="{'group_by': 'datetakesdata:day'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Vista de lista/árbol para tareas de tarea actual -->
    <record id="view_task_tree_smmonitor" model="ir.ui.view">
        <field name="name">project.task.tree.smmonitor</field>
        <field name="model">smm.task.analytics.date</field>
        <field name="arch" type="xml">
            <tree string="Tareas P.R.S." editable="top">
                <field name="allow_milestones" column_invisible="True"/>
                <field name="subtask_count" column_invisible="True"/>
                <field name="closed_subtask_count" column_invisible="True"/>
                <field name="company_id" column_invisible="True"/>
                <field name="project_id" column_invisible="True"/>
                <field name="id" optional="hide"/>
                <field name="smm_datetask_id"/>
                <field name="datetakesdata" optional="show"/>
                <field name="state" column_invisible="True" widget="project_task_state_selection" nolabel="1" options="{'is_toggle_mode': false}"/>
                <field name="milestone_id" invisible="not allow_milestones" context="{'default_project_id': project_id}" groups="project.group_project_milestone" optional="hide"/>
                <field name="partner_id" optional="hide" widget="res_partner_many2one" invisible="not project_id" options="{'no_open': True}"/>
                <field name="user_ids" optional="show" widget="many2many_avatar_user" string="Registrador"/>
                <field name="engagement" optional="show" widget="percentage_precision"/>
                <field name="interactions" optional="show"/>
                <field name="reach" optional="show"/>
                <field name="impressions" optional="show"/>
                <field name="smm_hashtag_task_ids" widget="many2many_tags" options="{'color_field': 'color'}"/>
                <field name="company_id" optional="hide" groups="base.group_multi_company" column_invisible="context.get('default_project_id')"/>
                <field name="date_deadline" optional="hide" widget="remaining_days" invisible="state in ['1_done', '1_canceled']"/>
                <field name="date_last_stage_update" optional="hide"/>
                <!-- <field name="tag_ids" optional="hide" widget="many2many_tags" options="{'color_field': 'color'}" context="{'project_id': project_id}"/> -->
                <!-- <field name="stage_id" column_invisible="context.get('set_visible', False)" optional="hide"/> -->
            </tree>
        </field>
    </record>

    <!-- Vista de gráfico para tareas de tarea actual -->
    <record id="view_task_graph_smmonitor" model="ir.ui.view">
        <field name="name">project.task.graph.smmonitor</field>
        <field name="model">smm.task.analytics.date</field>
        <field name="arch" type="xml">
            <graph string="Tareas P.R.S.">
                <field name="datetakesdata" interval="day"/>
                <field name="smm_datetask_id" type="col"/>
                <field name="engagement" type="row"/>
                <field name="interactions" type="row"/>
                <field name="reach" type="row"/>
                <field name="impressions" type="row"/>
            </graph>
        </field>
    </record>

    <!-- Vista de tabla dinámica tareas de tarea actual -->
    <record id="view_task_pivot_smmonitor" model="ir.ui.view">
        <field name="name">project.task.pivot.smmonitor</field>
        <field name="model">smm.task.analytics.date</field>
        <field name="arch" type="xml">
            <pivot string="Tareas P.R.S.">
                <field name="datetakesdata" interval="day" type="row"/>
                <field name="smm_datetask_id" type="col"/>
                <field name="engagement" type="measure"/>
                <field name="interactions" type="measure"/>
                <field name="reach" type="measure"/>
                <field name="impressions" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- Vista de calendario tareas de tarea actual -->
    <record id="view_task_calendar_smmonitor" model="ir.ui.view">
        <field name="name">project.task.calendar.smmonitor</field>
        <field name="model">smm.task.analytics.date</field>
        <field name="arch" type="xml">
            <calendar string="Tareas P.R.S." date_start="datetakesdata" color="smm_datetask_id">
                <field name="engagement"/>
                <field name="interactions"/>
                <field name="reach"/>
                <field name="impressions"/>
            </calendar>
        </field>
    </record>
</odoo>
